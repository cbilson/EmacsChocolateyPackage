# environment:
#   chocolateyApiKey:
#     secure: CPNSQvKUxo8opfNw9helbxnbt62zLmFDFt9fAbCUBuT9VWsQlzDw4f0t9rmbRCe9

build: off

# deploy:
#   - provider: Environment
#     name: production
#     on:
#       APPVEYOR_REPO_TAG: true


test_script:
  - ps: |
      # Create Chocolately Package
      Choco Pack .\emacs.nuspec
      # Try to install the package
      Choco Install emacs -source .\ -forcex86 -y
      Choco Uninstall emacs
      Choco Install emacs -source .\ -y

      # Create Emacs lite Chocolately Package
      Choco Pack .\emacs-lite.nuspec
      # Try to install the package
      Choco Install emacsw-lite -source .\ -forcex86 -y
      Choco Uninstall emacsw-lite -y
      Choco Install emacsw-lite -source .\ -y

# deploy_script:
#   - ps: |
#       # Create Chocolately Package
#       Choco Pack
#       # save the artifact
#       $version = ([xml](Get-Content .\emacs.nuspec)).package.metadata.version
#       Push-AppveyorArtifact ".\Emacs.$version.nupkg"
#       Choco apikey --key $chocolateyApiKey --source https://push.chocolatey.org/
#       Choco push ".\Emacs.$version.nupkg" --source https://push.chocolatey.org/
